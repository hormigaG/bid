<div class="text-center">
  <h2>Seleccione Productos</h2>
</div>
<read-code
  class="col-12"
  [inputMethod]="inputMethod"
  (searchByCode)="searchByCode($event)"
></read-code>
<ul class="list-group">
  <ng-container *ngFor="let item of products; let i = index">
    <li class="text-left list-group-item" (click)="openMoveLineModal(i)">
      <div class="row">
        <div class="text-center col-2 pt-0 pb-0 pl-0 pr-0">
          <div
            [ngClass]="{
              'text-bold': true,
              'text-white': true,
              'bg-warning': item['product_uom_qty'] > item['scanned_qty'] + item['qty_done'],
              'bg-success': item['product_uom_qty'] <= item['scanned_qty'] + item['qty_done']  
            }"
          >
            {{ item["scanned_qty"] + item['qty_done'] }}<br />
          </div>
        </div>
        <div class="col-8">
          <div>{{ item["product_id"][1] }}</div>
        </div>
        <div class="col-2"></div>
        <div class="col-12">Ubicacion Origen {{ item["location_id"][1] }}</div>
      </div>
    </li>
  </ng-container>
</ul>
<ng-template #moveLineModal let-modal>
  <div *ngIf="active_index !== undefined" class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">
          {{ products[active_index]["product_id"][1] }}
        </h5>
      </div>
      <div class="modal-body">
        <h2 class="bg-danger text-center text-white mb-0">
          {{ products[active_index]["scanned_qty"] }}
        </h2>
        <div class="bg-dark text-center text-white mt-0">Escaneados</div>

        <div *ngIf="products[active_index]['picking_id']">
          Remito: <strong>{{ products[active_index]["picking_id"][1] }}</strong>
        </div>
        <div>
          Unidad:
          <strong>{{ products[active_index]["product_uom_id"][1] }}</strong>
        </div>

        <div>
          Realizado/Total:
          <strong>{{ products[active_index]["qty_done"] }}</strong
          >/
          <strong>{{ products[active_index]["product_uom_qty"] }}</strong>
        </div>
        <div>
          Origen:
          <strong>{{ products[active_index]["location_id"][1] }}</strong>
        </div>

        <div *ngIf="products[active_index]['barcode']">
          Codigo de barra:
          <strong>{{ products[active_index]["barcode"] }}</strong>
        </div>
        <div>
          Codigo interno:
          <strong>{{ products[active_index]["default_code"] }}</strong>
        </div>
        <div class="btn-group w-100" role="group">
          <button
            type="button"
            (click)="qtyDir = -1"
            [ngClass]="{ btn: true, 'btn-dark': true, active: qtyDir == -1 }"
          >
            <i class="fa fa-minus"></i>
          </button>
          <button
            type="button"
            (click)="qtyDir = 1"
            [ngClass]="{ btn: true, 'btn-dark': true, active: qtyDir == 1 }"
          >
            <i class="fa fa-plus"></i>
          </button>
        </div>
        <div class="btn-group btn-group-lg w-100" role="group">
          <button
            type="button"
            (click)="addScannedQuantity(active_index, 1 * qtyDir)"
            [ngClass]="{ btn: true, 'btn-danger': true }"
          >
            1
          </button>
          <button
            type="button"
            (click)="addScannedQuantity(active_index, 5 * qtyDir)"
            [ngClass]="{ btn: true, 'btn-danger': true }"
          >
            5
          </button>
          <button
            type="button"
            (click)="addScannedQuantity(active_index, 10 * qtyDir)"
            [ngClass]="{ btn: true, 'btn-danger': true }"
          >
            10
          </button>
          <button
            type="button"
            (click)="addScannedQuantity(active_index, 50 * qtyDir)"
            [ngClass]="{ btn: true, 'btn-danger': true }"
          >
            50
          </button>
          <button
            type="button"
            (click)="addScannedQuantity(active_index, 100 * qtyDir)"
            [ngClass]="{ btn: true, 'btn-danger': true }"
          >
            100
          </button>
        </div>
        <hr />
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          aria-label="Close"
          (click)="modal.dismiss()"
        >
          Cerrar
        </button>
      </div>
    </div>
  </div>
</ng-template>
